function [C,E] = jacobiConstant(SV,mu)
% =======================================================================
%            Derivative of Non-dimensional State Vector in CR3BP
% =======================================================================
%
% Author : Kevin Charls (jackcruose47)
%
% Last Update : 30-10-2020
%
% Format : C = jacobiConstant(SV,mu)
%
% -----------------------------------------------------------------------
%                               INPUTS
% -----------------------------------------------------------------------
% SV            : Non-dimensional state vector in CR3BP [6x1]
% mu            : 3-body constant [1x1]
% -----------------------------------------------------------------------
%
% -----------------------------------------------------------------------
%                              OUTPUTS
% -----------------------------------------------------------------------
% C             : Jacobi Constant (Constant of Integral) [1x1]
% E             : Jacobi Energy (Specific Energy of Orbit) [1x1]
% -----------------------------------------------------------------------
% 
% -----------------------------------------------------------------------
%                            CHANGE LOG
% -----------------------------------------------------------------------
% 30-10-2020 : Code Created (Non-forced)
% -----------------------------------------------------------------------

% -- State vector
rx = SV(1);
ry = SV(2);
rz = SV(3);
vx = SV(4);
vy = SV(5);
vz = SV(6);

r13=sqrt( (rx+mu)^2 + ry^2 + rz^2 );
r23=sqrt( (rx-(1-mu))^2 + ry^2 + rz^2 );

v2 = vx^2+vy^2+vz^2;

C =  (rx^2+ry^2) + 2*(1-mu)/r13 + 2*mu/r23 - v2;

E = -C/2;

end